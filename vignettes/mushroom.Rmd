---
title: "Mushroom"
author: "Andreas M. Brandmaier"
date: "12/12/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Classification with Feedforward Networks

Example from the Proben1 dataset.

```{r pressure, echo=FALSE}

if(! exists("Trainable_derivative_get")) {
  dyn.load(paste("bnnlib", .Platform$dynlib.ext, sep=""))
  source("bnnlib.R")
  cacheMetaData(1)
}
```

```{r}
temp <- tempfile()
download.file("https://raw.githubusercontent.com/jeffheaton/proben1/master/mushroom/mushroom1.dt",temp)
dataset <- SequenceSet_load_from_proben_file(temp)
```


```{r}
SIGMOID_NODE = 2
network <-NetworkFactory_createFeedForwardNetwork(125, 20, 2, SIGMOID_NODE)
cg <- CGTrainer(network)
```

Train the network for some steps

```{r}
Trainer_add_abort_criterion__SWIG_0( cg, ConvergenceCriterion(), 5 )
Trainer_train__SWIG_1(cg, DataSet_get_training_set(dataset), DataSet_get_validation_set(dataset), 50)
```

Evaluate network performance using a winner-takes-all classification strategy.

```{r}
error_function = WinnerTakesAllErrorFunction();

Network_evaluate_error__SWIG_1(network, DataSet_get_test_set(dataset), error_function)

```
